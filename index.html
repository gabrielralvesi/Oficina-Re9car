<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RenoveCar Pro - Sistema Automotivo</title>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- html2pdf -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <!-- QR Code -->
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #e63946;
            --primary-dark: #c1121f;
            --secondary: #1e1e2f;
            --secondary-light: #2a2a3a;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
            --info: #3498db;
            --whatsapp: #25D366;
            --light: #f8f9fa;
            --gray: #6c757d;
            --border: #dee2e6;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 15px;
        }

        .dashboard {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 20px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .logo h1 {
            font-size: 24px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo i {
            font-size: 30px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-badge {
            background: rgba(255,255,255,0.2);
            padding: 8px 15px;
            border-radius: 30px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .date-time {
            background: rgba(0,0,0,0.2);
            padding: 8px 15px;
            border-radius: 30px;
            font-size: 13px;
        }

        /* Menu */
        .nav-menu {
            background: white;
            padding: 0 15px;
            display: flex;
            gap: 5px;
            border-bottom: 1px solid var(--border);
            overflow-x: auto;
        }

        .nav-item {
            padding: 12px 18px;
            cursor: pointer;
            color: var(--gray);
            font-weight: 500;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .nav-item:hover {
            color: var(--primary);
        }

        .nav-item.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .nav-item .badge {
            margin-left: 5px;
        }

        /* Conte√∫do */
        .content {
            background: white;
            padding: 25px;
            border-radius: 0 0 15px 15px;
            min-height: 500px;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-light) 100%);
            color: white;
            padding: 18px;
            border-radius: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .stat-info h3 {
            font-size: 13px;
            font-weight: 400;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .stat-info .value {
            font-size: 22px;
            font-weight: 700;
        }

        .stat-icon {
            font-size: 40px;
            opacity: 0.3;
        }

        /* WhatsApp Button */
        .btn-whatsapp {
            background: var(--whatsapp);
            color: white;
            border: none;
            padding: 6px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }

        .btn-whatsapp:hover {
            background: #128C7E;
            transform: translateY(-2px);
        }

        /* Status Badges */
        .status-badge {
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
        }

        .status-orcamento { background: #fff3cd; color: #856404; }
        .status-aprovado { background: #d4edda; color: #155724; }
        .status-andamento { background: #cce5ff; color: #004085; }
        .status-concluido { background: #d4edda; color: #155724; }
        .status-cancelado { background: #f8d7da; color: #721c24; }

        /* Alert Cards */
        .alert-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .alert-card {
            background: white;
            border-left: 4px solid;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .alert-card.warning {
            border-left-color: var(--warning);
        }

        .alert-card.danger {
            border-left-color: var(--danger);
        }

        .alert-card.success {
            border-left-color: var(--success);
        }

        /* Charts */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .chart-card {
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 18px;
        }

        /* Forms */
        .form-section {
            background: var(--light);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            font-size: 13px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 13px;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* Search */
        .search-box {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 14px;
        }

        .search-box:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* Buttons */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(230,57,70,0.3);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #27ae60;
            transform: translateY(-2px);
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-warning:hover {
            background: #e67e22;
            transform: translateY(-2px);
        }

        .btn-action {
            padding: 6px 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            margin: 0 2px;
            color: white;
            transition: all 0.3s;
        }

        .btn-action.success { background: var(--success); }
        .btn-action.danger { background: var(--danger); }
        .btn-action.info { background: var(--info); }
        .btn-action.warning { background: var(--warning); }
        .btn-action.primary { background: var(--primary); }
        .btn-action.whatsapp { background: var(--whatsapp); }
        .btn-action:hover { opacity: 0.8; transform: translateY(-2px); }

        /* Tables */
        .table-container {
            overflow-x: auto;
            border-radius: 10px;
            border: 1px solid var(--border);
            margin-top: 15px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }

        th {
            background: var(--secondary);
            color: white;
            padding: 12px;
            text-align: left;
            font-size: 13px;
        }

        td {
            padding: 10px;
            border-bottom: 1px solid var(--border);
            font-size: 13px;
        }

        tr:hover {
            background: var(--light);
        }

        /* Badges */
        .badge {
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
        }

        .badge-success { background: #d4edda; color: #155724; }
        .badge-danger { background: #f8d7da; color: #721c24; }
        .badge-warning { background: #fff3cd; color: #856404; }
        .badge-info { background: #d1ecf1; color: #0c5460; }
        .badge-whatsapp { background: var(--whatsapp); color: white; }

        /* Servi√ßos */
        .servico-linha {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
            background: white;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .servico-descricao { flex: 3; }
        .servico-valor { flex: 1; }

        /* QR Code */
        .qrcode-container {
            display: flex;
            justify-content: center;
            margin: 15px 0;
        }

        /* Or√ßamento PDF */
        .orcamento-pdf {
            font-family: 'Inter', sans-serif;
            padding: 20px;
        }

        .orcamento-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 20px;
        }

        .orcamento-header h1 {
            color: var(--primary);
            font-size: 28px;
            margin-bottom: 5px;
        }

        .orcamento-header h3 {
            color: var(--secondary);
            font-weight: normal;
        }

        .orcamento-info {
            margin-bottom: 30px;
            padding: 15px;
            background: var(--light);
            border-radius: 8px;
        }

        .orcamento-info p {
            margin: 5px 0;
            font-size: 14px;
        }

        .orcamento-validade {
            background: #fff3cd;
            border: 1px solid #ffeeba;
            padding: 10px;
            border-radius: 5px;
            margin: 15px 0;
            text-align: center;
            font-weight: bold;
        }

        .orcamento-tabela {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .orcamento-tabela th {
            background: var(--secondary);
            color: white;
            padding: 10px;
        }

        .orcamento-tabela td {
            padding: 8px;
            border-bottom: 1px solid var(--border);
        }

        .orcamento-total {
            text-align: right;
            font-size: 18px;
            font-weight: bold;
            margin: 20px 0;
            padding: 15px;
            background: var(--secondary);
            color: white;
            border-radius: 5px;
        }

        .orcamento-rodape {
            margin-top: 40px;
            text-align: center;
            font-size: 12px;
            color: var(--gray);
            border-top: 1px solid var(--border);
            padding-top: 20px;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
        }

        .modal-body {
            padding: 20px;
        }

        .modal-footer {
            padding: 15px 20px;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
        }

        /* Toast */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
        }

        .toast {
            background: white;
            border-radius: 8px;
            padding: 12px 18px;
            margin-bottom: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            gap: 10px;
            animation: slideIn 0.3s;
            border-left: 4px solid;
        }

        .toast.success { border-left-color: var(--success); }
        .toast.error { border-left-color: var(--danger); }
        .toast.warning { border-left-color: var(--warning); }
        .toast.info { border-left-color: var(--info); }
        .toast.whatsapp { border-left-color: var(--whatsapp); }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Loading */
        .loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.9);
            align-items: center;
            justify-content: center;
            z-index: 1002;
        }

        .loading.active {
            display: flex;
        }

        .spinner {
            width: 45px;
            height: 45px;
            border: 4px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 2px;
            background: var(--light);
            padding: 5px;
            border-radius: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 8px 15px;
            cursor: pointer;
            border-radius: 6px;
            color: var(--gray);
        }

        .tab.active {
            background: white;
            color: var(--primary);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* Print */
        @media print {
            .no-print { display: none; }
            .print-only { display: block; }
        }

        .print-only { display: none; }

        /* Responsive */
        @media (max-width: 768px) {
            .charts-grid { grid-template-columns: 1fr; }
            .header { flex-direction: column; text-align: center; }
            .user-info { justify-content: center; }
        }
    </style>
</head>
<body>
    <!-- Dashboard -->
    <div class="dashboard" id="dashboard">
        <div class="header">
            <div class="logo">
                <h1>
                    <i class="fas fa-car"></i>
                    RenoveCar Pro
                </h1>
            </div>
            <div class="user-info">
                <div class="user-badge">
                    <i class="fas fa-user-circle"></i>
                    <span id="userName">Admin</span>
                </div>
                <div class="date-time" id="currentDateTime"></div>
            </div>
        </div>

        <div class="nav-menu no-print">
            <div class="nav-item active" onclick="showSection('dashboard', this)">üìä Dashboard</div>
            <div class="nav-item" onclick="showSection('os', this)">üîß OS <span class="badge badge-warning" id="osCount"></span></div>
            <div class="nav-item" onclick="showSection('orcamentos', this)">üìù Or√ßamentos <span class="badge badge-info" id="orcamentosCount"></span></div>
            <div class="nav-item" onclick="showSection('clientes', this)">üë• Clientes</div>
            <div class="nav-item" onclick="showSection('veiculos', this)">üöó Ve√≠culos</div>
            <div class="nav-item" onclick="showSection('funcionarios', this)">üëî Funcion√°rios</div>
            <div class="nav-item" onclick="showSection('agenda', this)">üìÖ Agenda</div>
            <div class="nav-item" onclick="showSection('financeiro', this)">üí∞ Financeiro</div>
            <div class="nav-item" onclick="showSection('relatorios', this)">üìä Relat√≥rios</div>
            <div class="nav-item" onclick="showSection('config', this)">‚öôÔ∏è Config</div>
        </div>

        <div class="content" id="mainContent"></div>
    </div>

    <!-- Modal -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle"></h2>
                <button class="close-modal" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body" id="modalBody"></div>
            <div class="modal-footer">
                <button class="btn-action info" onclick="closeModal()">Fechar</button>
                <button class="btn-action success" id="modalConfirmBtn">Confirmar</button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Loading -->
    <div class="loading" id="loading">
        <div class="spinner"></div>
    </div>

    <script>
        // ==================== CONFIGURA√á√ïES ====================
        const CONFIG = {
            KM_MEDIO_DIA: 100,
            ALERTA_KM: 5000,
            ALERTA_DIAS: 90,
            VALIDADE_ORCAMENTO: 3, // dias de validade
            VERSAO: '2.2.0'
        };

        // ==================== ESTADO DA APLICA√á√ÉO ====================
        const App = {
            editId: null,
            editType: null,
            alertas: [],
            configuracoes: {
                empresa: 'RenoveCar Centro Automotivo',
                email: 'contato@renovecar.com',
                telefone: '(11) 99999-9999',
                endereco: 'Rua da Oficina, 123',
                cnpj: '12.345.678/0001-90',
                whatsapp: '5511999999999'
            },
            data: {
                os: [],
                orcamentos: [],
                clientes: [],
                veiculos: [],
                funcionarios: [],
                vales: [],
                agenda: [],
                financeiro: []
            }
        };

        // ==================== DADOS INICIAIS ====================
        const dadosIniciais = {
            os: [],
            orcamentos: [
                { 
                    id: 1, 
                    numero: 'ORC-001', 
                    clienteId: 1, 
                    clienteNome: 'Jo√£o Silva', 
                    clienteTelefone: '(11) 99999-9999',
                    clienteWhatsApp: '5511999999999',
                    veiculoId: 1,
                    veiculo: 'Gol 2020',
                    placa: 'ABC-1234',
                    km: 45230,
                    data: '2024-01-15',
                    validade: '2024-01-18',
                    status: 'aprovado',
                    servicos: [
                        { desc: 'Troca de √ìleo', valor: 150 },
                        { desc: 'Alinhamento', valor: 120 }
                    ],
                    valor: 270,
                    observacoes: 'Or√ßamento aprovado via WhatsApp',
                    dataEnvio: '2024-01-15',
                    dataAprovacao: '2024-01-15'
                }
            ],
            clientes: [
                { id: 1, nome: 'Jo√£o Silva', telefone: '(11) 99999-9999', whatsapp: '5511999999999', email: 'joao@email.com', endereco: 'Rua A, 123', cpf: '123.456.789-00' },
                { id: 2, nome: 'Maria Santos', telefone: '(11) 98888-8888', whatsapp: '5511988888888', email: 'maria@email.com', endereco: 'Av B, 456', cpf: '987.654.321-00' }
            ],
            veiculos: [
                { id: 1, clienteId: 1, clienteNome: 'Jo√£o Silva', modelo: 'Gol 2020', placa: 'ABC-1234', km: 45230, cor: 'Prata', ano: 2020, combustivel: 'Flex' },
                { id: 2, clienteId: 2, clienteNome: 'Maria Santos', modelo: 'Onix 2022', placa: 'XYZ-5678', km: 15320, cor: 'Branco', ano: 2022, combustivel: 'Flex' }
            ],
            funcionarios: [
                { id: 1, nome: 'Carlos Mec√¢nico', cargo: 'Mec√¢nico S√™nior', telefone: '(11) 96666-6666', salario: 3500, dataAdmissao: '2023-01-10', saldoVales: 0 }
            ],
            vales: [],
            agenda: [],
            financeiro: []
        };

        // ==================== INICIALIZA√á√ÉO ====================
        document.addEventListener('DOMContentLoaded', () => {
            updateDateTime();
            setInterval(updateDateTime, 1000);
            carregarDados();
            renderSection('dashboard');
        });

        // ==================== UTILIT√ÅRIOS ====================
        const showLoading = () => document.getElementById('loading').classList.add('active');
        const hideLoading = () => document.getElementById('loading').classList.remove('active');

        const showToast = (message, type = 'info') => {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            const icons = { 
                success: 'fa-check-circle', 
                error: 'fa-exclamation-circle', 
                warning: 'fa-exclamation-triangle', 
                info: 'fa-info-circle',
                whatsapp: 'fa-whatsapp'
            };
            toast.innerHTML = `<i class="fas ${icons[type] || icons.info}"></i> ${message}`;
            document.getElementById('toastContainer').appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        };

        const formatarMoeda = (valor) => {
            return valor.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        };

        const formatarData = (data) => {
            return new Date(data).toLocaleDateString('pt-BR');
        };

        const formatarTelefoneWhatsApp = (telefone) => {
            return telefone.replace(/\D/g, '');
        };

        const enviarWhatsApp = (numero, mensagem) => {
            const numeroFormatado = formatarTelefoneWhatsApp(numero);
            const mensagemCodificada = encodeURIComponent(mensagem);
            const url = `https://wa.me/${numeroFormatado}?text=${mensagemCodificada}`;
            window.open(url, '_blank');
            showToast('Mensagem preparada!', 'whatsapp');
        };

        const updateDateTime = () => {
            const now = new Date();
            document.getElementById('currentDateTime').textContent = 
                now.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit', year: 'numeric', hour: '2-digit', minute: '2-digit' });
        };

        const updateCounters = () => {
            document.getElementById('osCount').textContent = App.data.os.filter(o => o.status === 'andamento').length;
            document.getElementById('orcamentosCount').textContent = App.data.orcamentos.filter(o => o.status === 'enviado').length;
        };

        // ==================== PERSIST√äNCIA ====================
        const carregarDados = () => {
            try {
                const saved = localStorage.getItem('renovecar_pro');
                if (saved) {
                    const parsed = JSON.parse(saved);
                    App.data = parsed.data || dadosIniciais;
                    App.configuracoes = parsed.configuracoes || App.configuracoes;
                } else {
                    App.data = dadosIniciais;
                }
                
                verificarOrcamentosVencidos();
                updateCounters();
            } catch (e) {
                App.data = dadosIniciais;
            }
        };

        const salvarDados = () => {
            const backup = {
                data: App.data,
                configuracoes: App.configuracoes,
                versao: CONFIG.VERSAO,
                dataBackup: new Date().toISOString()
            };
            localStorage.setItem('renovecar_pro', JSON.stringify(backup));
            updateCounters();
            showToast('Dados salvos!', 'success');
        };

        // ==================== OR√áAMENTOS ====================
        const renderOrcamentos = () => {
            return `
                <div class="tabs no-print">
                    <div class="tab active" onclick="mostrarSubOrcamento('lista')">üìã Lista</div>
                    <div class="tab" onclick="mostrarSubOrcamento('novo')">‚ûï Novo</div>
                </div>
                <div id="subOrcamento">${renderListaOrcamentos()}</div>
            `;
        };

        const mostrarSubOrcamento = (secao) => {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.currentTarget.classList.add('active');
            const div = document.getElementById('subOrcamento');
            if (secao === 'lista') div.innerHTML = renderListaOrcamentos();
            else div.innerHTML = renderNovoOrcamento();
        };

        const renderListaOrcamentos = () => {
            return `
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>N¬∫</th>
                                <th>Cliente</th>
                                <th>Ve√≠culo</th>
                                <th>Data</th>
                                <th>Validade</th>
                                <th>Valor</th>
                                <th>Status</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${App.data.orcamentos.sort((a,b) => new Date(b.data) - new Date(a.data)).map(o => {
                                const hoje = new Date();
                                const validade = new Date(o.validade);
                                const diasRestantes = Math.ceil((validade - hoje) / (1000 * 60 * 60 * 24));
                                const vencido = hoje > validade;
                                
                                return `
                                    <tr>
                                        <td>${o.numero}</td>
                                        <td>${o.clienteNome}</td>
                                        <td>${o.veiculo}</td>
                                        <td>${formatarData(o.data)}</td>
                                        <td>
                                            ${formatarData(o.validade)}
                                            ${vencido ? '<span class="badge badge-danger">Vencido</span>' : 
                                              diasRestantes <= 1 ? '<span class="badge badge-warning">√öltimo dia</span>' : ''}
                                        </td>
                                        <td>${formatarMoeda(o.valor)}</td>
                                        <td>
                                            <span class="status-badge status-${o.status}">
                                                ${o.status === 'enviado' ? 'üì§ Enviado' : 
                                                  o.status === 'aprovado' ? '‚úÖ Aprovado' : 
                                                  o.status === 'recusado' ? '‚ùå Recusado' : 
                                                  '‚è≥ Pendente'}
                                            </span>
                                        </td>
                                        <td>
                                            <button class="btn-action info" onclick="verOrcamento(${o.id})">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                            <button class="btn-action whatsapp" onclick="enviarOrcamentoWhatsApp(${o.id})" ${o.status !== 'enviado' && o.status !== 'pendente' ? 'disabled' : ''}>
                                                <i class="fab fa-whatsapp"></i>
                                            </button>
                                            ${o.status === 'aprovado' ? 
                                                `<button class="btn-action success" onclick="criarOSdeOrcamento(${o.id})">
                                                    <i class="fas fa-clipboard-list"></i> OS
                                                </button>` : 
                                                o.status === 'enviado' ? 
                                                `<button class="btn-action success" onclick="aprovarOrcamento(${o.id})">
                                                    <i class="fas fa-check"></i> Aprovar
                                                </button>` : ''}
                                        </td>
                                    </tr>
                                `;
                            }).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        };

        const renderNovoOrcamento = () => {
            App.editId = null;
            window.servicos = window.servicos || [{ desc: '', valor: 0 }];
            
            return `
                <div class="form-section">
                    <h3>‚ûï Novo Or√ßamento</h3>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Cliente *</label>
                            <select id="orcCliente" onchange="carregarVeiculosClienteOrc()">
                                <option value="">Selecione</option>
                                ${App.data.clientes.map(c => `<option value="${c.id}" data-whatsapp="${c.whatsapp}" data-telefone="${c.telefone}">${c.nome}</option>`).join('')}
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Ve√≠culo *</label>
                            <select id="orcVeiculo">
                                <option value="">Selecione o cliente primeiro</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>KM Atual</label>
                            <input type="number" id="orcKm">
                        </div>
                    </div>
                    
                    <h4 style="margin: 15px 0;">Servi√ßos</h4>
                    <div id="servicosContainer"></div>
                    
                    <div style="display: flex; gap: 10px; margin: 15px 0;">
                        <button class="btn-action success" onclick="adicionarServico()">
                            <i class="fas fa-plus"></i> Adicionar Servi√ßo
                        </button>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-light) 100%); color: white; padding: 20px; border-radius: 8px; margin: 20px 0;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="font-size: 16px;">Valor Total:</span>
                            <span style="font-size: 28px; font-weight: bold;" id="osTotal">R$ 0,00</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Observa√ß√µes</label>
                        <textarea id="orcObs" rows="3" placeholder="Observa√ß√µes..."></textarea>
                    </div>
                    
                    <div style="display: flex; gap: 10px; justify-content: flex-end;">
                        <button class="btn-action warning" onclick="cancelarOrcamento()">Cancelar</button>
                        <button class="btn-action primary" onclick="salvarOrcamento('pendente')">
                            <i class="fas fa-save"></i> Salvar
                        </button>
                        <button class="btn-action whatsapp" onclick="salvarEEnviarOrcamento()">
                            <i class="fab fa-whatsapp"></i> Salvar e Enviar
                        </button>
                    </div>
                </div>
            `;
        };

        const carregarVeiculosClienteOrc = () => {
            const clienteId = document.getElementById('orcCliente').value;
            const veiculos = App.data.veiculos.filter(v => v.clienteId == clienteId);
            const select = document.getElementById('orcVeiculo');
            
            if (veiculos.length) {
                select.innerHTML = '<option value="">Selecione</option>' + 
                    veiculos.map(v => `<option value="${v.id}" data-km="${v.km}">${v.modelo} - ${v.placa}</option>`).join('');
            } else {
                select.innerHTML = '<option value="">Nenhum ve√≠culo cadastrado</option>';
            }
        };

        const salvarOrcamento = (status = 'pendente') => {
            const clienteId = document.getElementById('orcCliente').value;
            const veiculoId = document.getElementById('orcVeiculo').value;
            const km = document.getElementById('orcKm').value;
            const obs = document.getElementById('orcObs').value;

            if (!clienteId || !veiculoId) {
                showToast('Selecione cliente e ve√≠culo', 'warning');
                return false;
            }

            const servicosValidos = window.servicos.filter(s => s.desc.trim() && s.valor > 0);
            if (!servicosValidos.length) {
                showToast('Adicione pelo menos um servi√ßo', 'warning');
                return false;
            }

            const cliente = App.data.clientes.find(c => c.id == clienteId);
            const veiculo = App.data.veiculos.find(v => v.id == veiculoId);
            
            const hoje = new Date();
            const validade = new Date(hoje);
            validade.setDate(validade.getDate() + CONFIG.VALIDADE_ORCAMENTO);

            const novoOrcamento = {
                id: Date.now(),
                numero: `ORC-${String(App.data.orcamentos.length + 1).padStart(3, '0')}`,
                clienteId: parseInt(clienteId),
                clienteNome: cliente.nome,
                clienteTelefone: cliente.telefone,
                clienteWhatsApp: cliente.whatsapp,
                veiculoId: parseInt(veiculoId),
                veiculo: veiculo.modelo,
                placa: veiculo.placa,
                km: km,
                data: hoje.toISOString().split('T')[0],
                validade: validade.toISOString().split('T')[0],
                status: status,
                servicos: servicosValidos,
                valor: servicosValidos.reduce((s,i) => s + i.valor, 0),
                observacoes: obs
            };

            App.data.orcamentos.push(novoOrcamento);
            salvarDados();
            
            window.servicos = [{ desc: '', valor: 0 }];
            showToast('Or√ßamento salvo!', 'success');
            
            return novoOrcamento;
        };

        const salvarEEnviarOrcamento = async () => {
            const orcamento = salvarOrcamento('enviado');
            if (orcamento) {
                orcamento.dataEnvio = new Date().toISOString().split('T')[0];
                await gerarPDFOrcamento(orcamento.id, true);
            }
        };

        const gerarPDFOrcamento = async (id, enviarWhatsApp = false) => {
            const orcamento = App.data.orcamentos.find(o => o.id === id);
            if (!orcamento) return;

            const servicosHTML = orcamento.servicos.map(s => `
                <tr>
                    <td>${s.desc}</td>
                    <td style="text-align: right;">${formatarMoeda(s.valor)}</td>
                </tr>
            `).join('');

            const hoje = new Date();
            const validade = new Date(orcamento.validade);
            const diasRestantes = Math.ceil((validade - hoje) / (1000 * 60 * 60 * 24));

            const html = `
                <div class="orcamento-pdf" id="orcamento-${id}">
                    <div class="orcamento-header">
                        <h1>${App.configuracoes.empresa}</h1>
                        <h3>Or√ßamento ${orcamento.numero}</h3>
                    </div>
                    
                    <div class="orcamento-info">
                        <p><strong>Cliente:</strong> ${orcamento.clienteNome}</p>
                        <p><strong>Ve√≠culo:</strong> ${orcamento.veiculo} - ${orcamento.placa}</p>
                        <p><strong>KM:</strong> ${orcamento.km || '-'}</p>
                        <p><strong>Data:</strong> ${formatarData(orcamento.data)}</p>
                    </div>
                    
                    <div class="orcamento-validade">
                        ‚è∞ Este or√ßamento √© v√°lido at√© ${formatarData(orcamento.validade)} 
                        (${diasRestantes} ${diasRestantes === 1 ? 'dia' : 'dias'})
                    </div>
                    
                    <table class="orcamento-tabela">
                        <thead>
                            <tr>
                                <th>Servi√ßo</th>
                                <th>Valor</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${servicosHTML}
                        </tbody>
                    </table>
                    
                    <div class="orcamento-total">
                        Total: ${formatarMoeda(orcamento.valor)}
                    </div>
                    
                    ${orcamento.observacoes ? `
                        <p><strong>Observa√ß√µes:</strong> ${orcamento.observacoes}</p>
                    ` : ''}
                    
                    <div class="orcamento-rodape">
                        <p>Para aprovar este or√ßamento, responda esta mensagem ou entre em contato:</p>
                        <p>üìû ${App.configuracoes.telefone} | üìß ${App.configuracoes.email}</p>
                        <p>üìç ${App.configuracoes.endereco}</p>
                        <p>üí∞ Formas de pagamento: Dinheiro | Cart√£o | PIX</p>
                        <p>Gerado em ${new Date().toLocaleString()}</p>
                    </div>
                </div>
            `;

            // Criar elemento tempor√°rio
            const element = document.createElement('div');
            element.innerHTML = html;
            document.body.appendChild(element);

            // Gerar PDF
            const opt = {
                margin: [0.5, 0.5, 0.5, 0.5],
                filename: `Orcamento_${orcamento.numero}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
            };

            await html2pdf().set(opt).from(element).save();
            document.body.removeChild(element);

            if (enviarWhatsApp && orcamento.clienteWhatsApp) {
                const mensagem = `Ol√° ${orcamento.clienteNome}! üëã\n\n` +
                    `Segue o or√ßamento ${orcamento.numero} conforme solicitado.\n` +
                    `üìÖ V√°lido at√©: ${formatarData(orcamento.validade)}\n` +
                    `üí∞ Valor total: ${formatarMoeda(orcamento.valor)}\n\n` +
                    `Para aprovar, √© s√≥ responder esta mensagem com "APROVADO" ou clicar no link:\n` +
                    `${window.location.origin}/aprovar-orcamento?id=${orcamento.id}`;
                
                enviarWhatsApp(orcamento.clienteWhatsApp, mensagem);
            }

            showToast('PDF gerado com sucesso!', 'success');
        };

        const verOrcamento = (id) => {
            const o = App.data.orcamentos.find(o => o.id === id);
            const servicos = o.servicos.map(s => `<li>${s.desc}: ${formatarMoeda(s.valor)}</li>`).join('');
            
            openModal(
                `Or√ßamento ${o.numero}`,
                `
                    <div style="line-height: 1.8;">
                        <p><strong>Cliente:</strong> ${o.clienteNome}</p>
                        <p><strong>Telefone:</strong> ${o.clienteTelefone}</p>
                        <p><strong>WhatsApp:</strong> ${o.clienteWhatsApp || '-'}</p>
                        <p><strong>Ve√≠culo:</strong> ${o.veiculo} - ${o.placa}</p>
                        <p><strong>KM:</strong> ${o.km || '-'}</p>
                        <p><strong>Data:</strong> ${formatarData(o.data)}</p>
                        <p><strong>Validade:</strong> ${formatarData(o.validade)}</p>
                        <p><strong>Status:</strong> <span class="status-badge status-${o.status}">${o.status}</span></p>
                        
                        <h4 style="margin: 15px 0 5px;">Servi√ßos:</h4>
                        <ul style="margin-left: 20px;">${servicos}</ul>
                        
                        <p><strong>Total:</strong> ${formatarMoeda(o.valor)}</p>
                        ${o.observacoes ? `<p><strong>Obs:</strong> ${o.observacoes}</p>` : ''}
                        ${o.dataEnvio ? `<p><strong>Enviado em:</strong> ${formatarData(o.dataEnvio)}</p>` : ''}
                        ${o.dataAprovacao ? `<p><strong>Aprovado em:</strong> ${formatarData(o.dataAprovacao)}</p>` : ''}
                    </div>
                `,
                closeModal
            );
        };

        const enviarOrcamentoWhatsApp = (id) => {
            gerarPDFOrcamento(id, true);
        };

        const aprovarOrcamento = (id) => {
            if (confirm('Confirmar aprova√ß√£o do or√ßamento?')) {
                const orcamento = App.data.orcamentos.find(o => o.id === id);
                orcamento.status = 'aprovado';
                orcamento.dataAprovacao = new Date().toISOString().split('T')[0];
                salvarDados();
                
                showToast('Or√ßamento aprovado!', 'success');
                renderSection('orcamentos');
            }
        };

        const criarOSdeOrcamento = (id) => {
            const orcamento = App.data.orcamentos.find(o => o.id === id);
            
            const novaOS = {
                id: Date.now(),
                numero: `OS-${String(App.data.os.length + 1).padStart(3, '0')}`,
                clienteId: orcamento.clienteId,
                clienteNome: orcamento.clienteNome,
                clienteTelefone: orcamento.clienteTelefone,
                veiculoId: orcamento.veiculoId,
                veiculo: orcamento.veiculo,
                placa: orcamento.placa,
                km: orcamento.km,
                data: new Date().toISOString().split('T')[0],
                status: 'andamento',
                servicos: orcamento.servicos,
                valor: orcamento.valor,
                observacoes: `OS gerada a partir do or√ßamento ${orcamento.numero}\n${orcamento.observacoes || ''}`,
                orcamentoOrigem: orcamento.id
            };

            App.data.os.push(novaOS);
            orcamento.status = 'convertido';
            
            // Adicionar ao financeiro
            App.data.financeiro.push({
                id: Date.now(),
                tipo: 'entrada',
                descricao: `OS ${novaOS.numero} - ${orcamento.clienteNome}`,
                valor: orcamento.valor,
                data: novaOS.data,
                categoria: 'Servi√ßos',
                status: 'pendente'
            });

            salvarDados();
            showToast('OS criada com sucesso!', 'success');
            renderSection('os');
        };

        const verificarOrcamentosVencidos = () => {
            const hoje = new Date();
            App.data.orcamentos.forEach(o => {
                if (o.status === 'enviado' || o.status === 'pendente') {
                    const validade = new Date(o.validade);
                    if (hoje > validade) {
                        o.status = 'vencido';
                    }
                }
            });
        };

        const cancelarOrcamento = () => {
            window.servicos = [{ desc: '', valor: 0 }];
            mostrarSubOrcamento('lista');
        };

        // ==================== ORDENS DE SERVI√áO ====================
        const renderOS = () => {
            return `
                <div class="tabs no-print">
                    <div class="tab active" onclick="mostrarSubOS('ativas')">üîß Em Andamento</div>
                    <div class="tab" onclick="mostrarSubOS('historico')">üìã Hist√≥rico</div>
                </div>
                <div id="subOS">${renderOSAtivas()}</div>
            `;
        };

        const mostrarSubOS = (secao) => {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.currentTarget.classList.add('active');
            const div = document.getElementById('subOS');
            if (secao === 'ativas') div.innerHTML = renderOSAtivas();
            else div.innerHTML = renderOSHistorico();
        };

        const renderOSAtivas = () => {
            const ativas = App.data.os.filter(o => o.status === 'andamento');
            
            return `
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>N¬∫</th>
                                <th>Cliente</th>
                                <th>Ve√≠culo</th>
                                <th>Data</th>
                                <th>Valor</th>
                                <th>Status</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${ativas.map(o => `
                                <tr>
                                    <td>${o.numero}</td>
                                    <td>${o.clienteNome}</td>
                                    <td>${o.veiculo}</td>
                                    <td>${formatarData(o.data)}</td>
                                    <td>${formatarMoeda(o.valor)}</td>
                                    <td><span class="status-badge status-andamento">Em andamento</span></td>
                                    <td>
                                        <button class="btn-action info" onclick="verOS(${o.id})">Ver</button>
                                        <button class="btn-action success" onclick="imprimirOS(${o.id})">
                                            <i class="fas fa-print"></i>
                                        </button>
                                        <button class="btn-action success" onclick="concluirOS(${o.id})">
                                            <i class="fas fa-check"></i>
                                        </button>
                                    </td>
                                </tr>
                            `).join('')}
                            ${ativas.length === 0 ? '<tr><td colspan="7" style="text-align: center;">Nenhuma OS em andamento</td></tr>' : ''}
                        </tbody>
                    </table>
                </div>
            `;
        };

        const renderOSHistorico = () => {
            const historico = App.data.os.filter(o => o.status !== 'andamento');
            
            return `
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>N¬∫</th>
                                <th>Cliente</th>
                                <th>Ve√≠culo</th>
                                <th>Data</th>
                                <th>Valor</th>
                                <th>Status</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${historico.map(o => `
                                <tr>
                                    <td>${o.numero}</td>
                                    <td>${o.clienteNome}</td>
                                    <td>${o.veiculo}</td>
                                    <td>${formatarData(o.data)}</td>
                                    <td>${formatarMoeda(o.valor)}</td>
                                    <td><span class="status-badge status-${o.status}">${o.status}</span></td>
                                    <td>
                                        <button class="btn-action info" onclick="verOS(${o.id})">Ver</button>
                                        <button class="btn-action success" onclick="imprimirOS(${o.id})">
                                            <i class="fas fa-print"></i>
                                        </button>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        };

        const verOS = (id) => {
            const os = App.data.os.find(o => o.id === id);
            const servicos = os.servicos.map(s => `<li>${s.desc}: ${formatarMoeda(s.valor)}</li>`).join('');
            
            openModal(
                `OS ${os.numero}`,
                `
                    <div style="line-height: 1.8;">
                        <p><strong>Cliente:</strong> ${os.clienteNome}</p>
                        <p><strong>Telefone:</strong> ${os.clienteTelefone || '-'}</p>
                        <p><strong>Ve√≠culo:</strong> ${os.veiculo} - ${os.placa}</p>
                        <p><strong>KM:</strong> ${os.km || '-'} km</p>
                        <p><strong>Data:</strong> ${formatarData(os.data)}</p>
                        
                        <h4 style="margin: 15px 0 5px;">Servi√ßos:</h4>
                        <ul style="margin-left: 20px;">${servicos}</ul>
                        
                        <p><strong>Valor Total:</strong> ${formatarMoeda(os.valor)}</p>
                        ${os.observacoes ? `<p><strong>Observa√ß√µes:</strong> ${os.observacoes}</p>` : ''}
                    </div>
                `,
                closeModal
            );
        };

        const concluirOS = (id) => {
            if (confirm('Confirmar conclus√£o da OS?')) {
                const os = App.data.os.find(o => o.id === id);
                os.status = 'concluido';
                
                // Atualizar financeiro se tiver registro pendente
                const financeiro = App.data.financeiro.find(f => f.descricao.includes(os.numero));
                if (financeiro) {
                    financeiro.status = 'pago';
                }
                
                salvarDados();
                showToast('OS conclu√≠da!', 'success');
                renderSection('os');
            }
        };

        const imprimirOS = (id) => {
            const os = App.data.os.find(o => o.id === id);
            const servicos = os.servicos.map(s => `
                <tr>
                    <td>${s.desc}</td>
                    <td style="text-align: right;">${formatarMoeda(s.valor)}</td>
                </tr>
            `).join('');
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>OS ${os.numero}</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 40px; }
                        .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #e63946; padding-bottom: 20px; }
                        .header h1 { color: #e63946; margin: 0; }
                        .info { margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 5px; }
                        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                        th { background: #1e1e2f; color: white; padding: 10px; text-align: left; }
                        td { padding: 10px; border-bottom: 1px solid #dee2e6; }
                        .total { font-size: 18px; font-weight: bold; text-align: right; margin-top: 20px; padding: 15px; background: #1e1e2f; color: white; border-radius: 5px; }
                        .footer { margin-top: 40px; text-align: center; color: #6c757d; font-size: 12px; border-top: 1px solid #dee2e6; padding-top: 20px; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>${App.configuracoes.empresa}</h1>
                        <h3>Ordem de Servi√ßo ${os.numero}</h3>
                    </div>
                    
                    <div class="info">
                        <p><strong>Cliente:</strong> ${os.clienteNome}</p>
                        <p><strong>Telefone:</strong> ${os.clienteTelefone || '-'}</p>
                        <p><strong>Ve√≠culo:</strong> ${os.veiculo} - ${os.placa}</p>
                        <p><strong>KM:</strong> ${os.km || '-'} km</p>
                        <p><strong>Data:</strong> ${formatarData(os.data)}</p>
                    </div>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>Servi√ßo</th>
                                <th>Valor</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${servicos}
                        </tbody>
                    </table>
                    
                    <div class="total">
                        Total: ${formatarMoeda(os.valor)}
                    </div>
                    
                    ${os.observacoes ? `<p><strong>Observa√ß√µes:</strong> ${os.observacoes}</p>` : ''}
                    
                    <div class="footer">
                        <p>Documento gerado em ${new Date().toLocaleString()}</p>
                        <p>${App.configuracoes.endereco} | Tel: ${App.configuracoes.telefone}</p>
                    </div>
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        };

        // ==================== DASHBOARD ====================
        const renderDashboard = () => {
            const mes = new Date().getMonth();
            
            const orcamentosPendentes = App.data.orcamentos.filter(o => o.status === 'enviado' || o.status === 'pendente').length;
            const orcamentosAprovados = App.data.orcamentos.filter(o => o.status === 'aprovado').length;
            const osAndamento = App.data.os.filter(o => o.status === 'andamento').length;
            
            return `
                <div class="stats-grid">
                    <div class="stat-card" onclick="showSection('orcamentos', document.querySelectorAll('.nav-item')[2])">
                        <div>
                            <h3>Or√ßamentos</h3>
                            <div class="value">${orcamentosPendentes}</div>
                            <small>${orcamentosAprovados} aprovados</small>
                        </div>
                        <i class="fas fa-file-invoice stat-icon"></i>
                    </div>
                    <div class="stat-card" onclick="showSection('os', document.querySelectorAll('.nav-item')[1])">
                        <div>
                            <h3>OS em Andamento</h3>
                            <div class="value">${osAndamento}</div>
                        </div>
                        <i class="fas fa-clipboard-list stat-icon"></i>
                    </div>
                </div>

                ${App.data.orcamentos.filter(o => o.status === 'enviado').length > 0 ? `
                    <div class="alert-grid">
                        <h3 style="grid-column: 1/-1;">üìù Or√ßamentos Aguardando Aprova√ß√£o</h3>
                        ${App.data.orcamentos.filter(o => o.status === 'enviado').slice(0, 3).map(o => {
                            const hoje = new Date();
                            const validade = new Date(o.validade);
                            const diasRestantes = Math.ceil((validade - hoje) / (1000 * 60 * 60 * 24));
                            
                            return `
                                <div class="alert-card warning">
                                    <div>
                                        <h4>${o.clienteNome} - ${o.numero}</h4>
                                        <p>${formatarMoeda(o.valor)} - V√°lido por ${diasRestantes} dias</p>
                                    </div>
                                    <button class="btn-action whatsapp" onclick="enviarOrcamentoWhatsApp(${o.id})">
                                        <i class="fab fa-whatsapp"></i> Lembrar
                                    </button>
                                </div>
                            `;
                        }).join('')}
                    </div>
                ` : ''}

                <div class="form-section">
                    <h3>üìã √öltimos Or√ßamentos</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>N¬∫</th>
                                    <th>Cliente</th>
                                    <th>Valor</th>
                                    <th>Validade</th>
                                    <th>Status</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${App.data.orcamentos.slice(0, 5).map(o => `
                                    <tr>
                                        <td>${o.numero}</td>
                                        <td>${o.clienteNome}</td>
                                        <td>${formatarMoeda(o.valor)}</td>
                                        <td>${formatarData(o.validade)}</td>
                                        <td><span class="status-badge status-${o.status}">${o.status}</span></td>
                                        <td>
                                            <button class="btn-action info" onclick="verOrcamento(${o.id})">Ver</button>
                                            ${o.status === 'enviado' ? 
                                                `<button class="btn-action success" onclick="aprovarOrcamento(${o.id})">Aprovar</button>` : ''}
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        };

        // ==================== CLIENTES ====================
        const renderClientes = () => {
            return `
                <div class="tabs no-print">
                    <div class="tab active" onclick="mostrarSubCliente('lista')">üìã Lista</div>
                    <div class="tab" onclick="mostrarSubCliente('novo')">‚ûï Novo</div>
                </div>
                <div id="subCliente">${renderListaClientes()}</div>
            `;
        };

        const mostrarSubCliente = (secao) => {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.currentTarget.classList.add('active');
            const div = document.getElementById('subCliente');
            if (secao === 'lista') div.innerHTML = renderListaClientes();
            else div.innerHTML = renderNovoCliente();
        };

        const renderListaClientes = () => {
            return `
                <input type="text" class="search-box" placeholder="üîç Buscar cliente..." onkeyup="buscarClientes(this.value)">
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Telefone</th>
                                <th>WhatsApp</th>
                                <th>Email</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="tabelaClientes">
                            ${App.data.clientes.map(c => `
                                <tr>
                                    <td>${c.nome}</td>
                                    <td>${c.telefone}</td>
                                    <td>
                                        ${c.whatsapp ? 
                                            `<button class="btn-action whatsapp" onclick="enviarWhatsApp('${c.whatsapp}', 'Ol√° ${c.nome}! Tudo bem?')">
                                                <i class="fab fa-whatsapp"></i>
                                            </button>` : '-'}
                                    </td>
                                    <td>${c.email || '-'}</td>
                                    <td>
                                        <button class="btn-action info" onclick="verCliente(${c.id})"><i class="fas fa-eye"></i></button>
                                        <button class="btn-action warning" onclick="editarCliente(${c.id})"><i class="fas fa-edit"></i></button>
                                        <button class="btn-action success" onclick="novoOrcamentoCliente(${c.id})"><i class="fas fa-file-invoice"></i></button>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        };

        const renderNovoCliente = () => {
            return `
                <div class="form-section">
                    <h3>‚ûï Novo Cliente</h3>
                    <div class="form-grid">
                        <input type="text" id="clienteNome" placeholder="Nome *">
                        <input type="text" id="clienteTelefone" placeholder="Telefone *">
                        <input type="text" id="clienteWhatsApp" placeholder="WhatsApp (5511999999999)">
                        <input type="email" id="clienteEmail" placeholder="Email">
                    </div>
                    <button class="btn-action success" onclick="salvarCliente()">Salvar</button>
                </div>
            `;
        };

        const buscarClientes = (termo) => {
            const filtrados = App.data.clientes.filter(c => 
                c.nome.toLowerCase().includes(termo.toLowerCase()) ||
                c.telefone.includes(termo) ||
                (c.whatsapp && c.whatsapp.includes(termo))
            );
            
            document.getElementById('tabelaClientes').innerHTML = filtrados.map(c => `
                <tr>
                    <td>${c.nome}</td>
                    <td>${c.telefone}</td>
                    <td>
                        ${c.whatsapp ? 
                            `<button class="btn-action whatsapp" onclick="enviarWhatsApp('${c.whatsapp}', 'Ol√° ${c.nome}! Tudo bem?')">
                                <i class="fab fa-whatsapp"></i>
                            </button>` : '-'}
                    </td>
                    <td>${c.email || '-'}</td>
                    <td>
                        <button class="btn-action info" onclick="verCliente(${c.id})"><i class="fas fa-eye"></i></button>
                        <button class="btn-action warning" onclick="editarCliente(${c.id})"><i class="fas fa-edit"></i></button>
                        <button class="btn-action success" onclick="novoOrcamentoCliente(${c.id})"><i class="fas fa-file-invoice"></i></button>
                    </td>
                </tr>
            `).join('');
        };

        const salvarCliente = () => {
            const nome = document.getElementById('clienteNome').value;
            const telefone = document.getElementById('clienteTelefone').value;
            
            if (!nome || !telefone) {
                showToast('Nome e telefone s√£o obrigat√≥rios', 'warning');
                return;
            }

            App.data.clientes.push({
                id: Date.now(),
                nome,
                telefone,
                whatsapp: document.getElementById('clienteWhatsApp').value,
                email: document.getElementById('clienteEmail').value
            });

            salvarDados();
            showToast('Cliente cadastrado!', 'success');
            mostrarSubCliente('lista');
        };

        const verCliente = (id) => {
            const c = App.data.clientes.find(c => c.id === id);
            const orcamentos = App.data.orcamentos.filter(o => o.clienteId === id);
            const os = App.data.os.filter(o => o.clienteId === id);
            
            openModal(
                c.nome,
                `
                    <p><strong>Telefone:</strong> ${c.telefone}</p>
                    <p><strong>WhatsApp:</strong> ${c.whatsapp || '-'}</p>
                    <p><strong>Email:</strong> ${c.email || '-'}</p>
                    <p><strong>Or√ßamentos:</strong> ${orcamentos.length}</p>
                    <p><strong>OS Realizadas:</strong> ${os.length}</p>
                `,
                closeModal
            );
        };

        const editarCliente = (id) => {
            // Implementar edi√ß√£o
            showToast('Edi√ß√£o em desenvolvimento', 'info');
        };

        const novoOrcamentoCliente = (id) => {
            showSection('orcamentos', document.querySelectorAll('.nav-item')[2]);
            setTimeout(() => {
                document.getElementById('orcCliente').value = id;
                carregarVeiculosClienteOrc();
            }, 500);
        };

        // ==================== VE√çCULOS ====================
        const renderVeiculos = () => {
            return `
                <div class="tabs no-print">
                    <div class="tab active" onclick="mostrarSubVeiculo('lista')">üìã Lista</div>
                    <div class="tab" onclick="mostrarSubVeiculo('novo')">‚ûï Novo</div>
                </div>
                <div id="subVeiculo">${renderListaVeiculos()}</div>
            `;
        };

        const mostrarSubVeiculo = (secao) => {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.currentTarget.classList.add('active');
            const div = document.getElementById('subVeiculo');
            if (secao === 'lista') div.innerHTML = renderListaVeiculos();
            else div.innerHTML = renderNovoVeiculo();
        };

        const renderListaVeiculos = () => {
            return `
                <input type="text" class="search-box" placeholder="üîç Buscar ve√≠culo..." onkeyup="buscarVeiculos(this.value)">
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Cliente</th>
                                <th>Modelo</th>
                                <th>Placa</th>
                                <th>KM</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="tabelaVeiculos">
                            ${App.data.veiculos.map(v => {
                                const cliente = App.data.clientes.find(c => c.id === v.clienteId);
                                return `
                                    <tr>
                                        <td>${cliente ? cliente.nome : 'N/A'}</td>
                                        <td>${v.modelo}</td>
                                        <td>${v.placa}</td>
                                        <td>${v.km} km</td>
                                        <td>
                                            <button class="btn-action danger" onclick="excluirVeiculo(${v.id})">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </td>
                                    </tr>
                                `;
                            }).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        };

        const renderNovoVeiculo = () => {
            return `
                <div class="form-section">
                    <h3>‚ûï Novo Ve√≠culo</h3>
                    <div class="form-grid">
                        <select id="veicCliente">
                            <option value="">Selecione o cliente</option>
                            ${App.data.clientes.map(c => `<option value="${c.id}">${c.nome}</option>`).join('')}
                        </select>
                        <input type="text" id="veicModelo" placeholder="Modelo">
                        <input type="text" id="veicPlaca" placeholder="Placa">
                        <input type="number" id="veicKm" placeholder="KM">
                    </div>
                    <button class="btn-action success" onclick="salvarVeiculo()">Salvar</button>
                </div>
            `;
        };

        const buscarVeiculos = (termo) => {
            const filtrados = App.data.veiculos.filter(v => 
                v.modelo.toLowerCase().includes(termo.toLowerCase()) ||
                v.placa.toLowerCase().includes(termo.toLowerCase())
            );
            
            document.getElementById('tabelaVeiculos').innerHTML = filtrados.map(v => {
                const cliente = App.data.clientes.find(c => c.id === v.clienteId);
                return `
                    <tr>
                        <td>${cliente ? cliente.nome : 'N/A'}</td>
                        <td>${v.modelo}</td>
                        <td>${v.placa}</td>
                        <td>${v.km} km</td>
                        <td>
                            <button class="btn-action danger" onclick="excluirVeiculo(${v.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
        };

        const salvarVeiculo = () => {
            const clienteId = document.getElementById('veicCliente').value;
            const modelo = document.getElementById('veicModelo').value;
            const placa = document.getElementById('veicPlaca').value;
            const km = parseInt(document.getElementById('veicKm').value);

            if (!clienteId || !modelo || !placa || !km) {
                showToast('Preencha todos os campos', 'warning');
                return;
            }

            const cliente = App.data.clientes.find(c => c.id == clienteId);

            App.data.veiculos.push({
                id: Date.now(),
                clienteId: parseInt(clienteId),
                clienteNome: cliente.nome,
                modelo,
                placa: placa.toUpperCase(),
                km
            });

            salvarDados();
            showToast('Ve√≠culo cadastrado!', 'success');
            mostrarSubVeiculo('lista');
        };

        const excluirVeiculo = (id) => {
            if (confirm('Excluir este ve√≠culo?')) {
                App.data.veiculos = App.data.veiculos.filter(v => v.id !== id);
                salvarDados();
                showToast('Ve√≠culo exclu√≠do', 'success');
                mostrarSubVeiculo('lista');
            }
        };

        // ==================== FUNCION√ÅRIOS ====================
        const renderFuncionarios = () => {
            return `
                <div class="tabs no-print">
                    <div class="tab active" onclick="mostrarSubFuncionario('lista')">üëî Funcion√°rios</div>
                    <div class="tab" onclick="mostrarSubFuncionario('novo')">‚ûï Novo</div>
                </div>
                <div id="subFuncionario">${renderListaFuncionarios()}</div>
            `;
        };

        const mostrarSubFuncionario = (secao) => {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.currentTarget.classList.add('active');
            const div = document.getElementById('subFuncionario');
            if (secao === 'lista') div.innerHTML = renderListaFuncionarios();
            else div.innerHTML = renderNovoFuncionario();
        };

        const renderListaFuncionarios = () => {
            return `
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Cargo</th>
                                <th>Telefone</th>
                                <th>Sal√°rio</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${App.data.funcionarios.map(f => `
                                <tr>
                                    <td>${f.nome}</td>
                                    <td>${f.cargo}</td>
                                    <td>${f.telefone}</td>
                                    <td>${formatarMoeda(f.salario)}</td>
                                    <td>
                                        <button class="btn-action danger" onclick="excluirFuncionario(${f.id})">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        };

        const renderNovoFuncionario = () => {
            return `
                <div class="form-section">
                    <h3>‚ûï Novo Funcion√°rio</h3>
                    <div class="form-grid">
                        <input type="text" id="funcNome" placeholder="Nome">
                        <input type="text" id="funcCargo" placeholder="Cargo">
                        <input type="text" id="funcTelefone" placeholder="Telefone">
                        <input type="number" id="funcSalario" placeholder="Sal√°rio">
                    </div>
                    <button class="btn-action success" onclick="salvarFuncionario()">Salvar</button>
                </div>
            `;
        };

        const salvarFuncionario = () => {
            const nome = document.getElementById('funcNome').value;
            const cargo = document.getElementById('funcCargo').value;
            const salario = parseFloat(document.getElementById('funcSalario').value);

            if (!nome || !cargo || !salario) {
                showToast('Preencha todos os campos', 'warning');
                return;
            }

            App.data.funcionarios.push({
                id: Date.now(),
                nome,
                cargo,
                telefone: document.getElementById('funcTelefone').value,
                salario
            });

            salvarDados();
            showToast('Funcion√°rio cadastrado!', 'success');
            mostrarSubFuncionario('lista');
        };

        const excluirFuncionario = (id) => {
            if (confirm('Excluir este funcion√°rio?')) {
                App.data.funcionarios = App.data.funcionarios.filter(f => f.id !== id);
                salvarDados();
                showToast('Funcion√°rio exclu√≠do', 'success');
                mostrarSubFuncionario('lista');
            }
        };

        // ==================== AGENDA ====================
        const renderAgenda = () => {
            return `
                <div class="tabs no-print">
                    <div class="tab active" onclick="mostrarSubAgenda('hoje')">üìÖ Hoje</div>
                    <div class="tab" onclick="mostrarSubAgenda('semana')">üìÜ Semana</div>
                    <div class="tab" onclick="mostrarSubAgenda('novo')">‚ûï Novo</div>
                </div>
                <div id="subAgenda">${renderAgendaHoje()}</div>
            `;
        };

        const mostrarSubAgenda = (secao) => {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.currentTarget.classList.add('active');
            const div = document.getElementById('subAgenda');
            if (secao === 'hoje') div.innerHTML = renderAgendaHoje();
            else if (secao === 'semana') div.innerHTML = renderAgendaSemana();
            else div.innerHTML = renderNovoAgendamento();
        };

        const renderAgendaHoje = () => {
            const hoje = new Date().toISOString().split('T')[0];
            const agendamentos = App.data.agenda.filter(a => a.data === hoje);
            
            return `
                <div class="form-section">
                    <h3>üìÖ Agendamentos de Hoje</h3>
                    ${agendamentos.length ? agendamentos.map(a => `
                        <div class="alert-card success" style="margin-bottom: 10px;">
                            <div>
                                <h4>${a.clienteNome} - ${a.hora}</h4>
                                <p>${a.servico}</p>
                            </div>
                            <button class="btn-action whatsapp" onclick="enviarWhatsApp('${a.whatsapp}', 'Lembrete: ${a.servico} hoje √†s ${a.hora}')">
                                <i class="fab fa-whatsapp"></i>
                            </button>
                        </div>
                    `).join('') : '<p>Nenhum agendamento para hoje</p>'}
                </div>
            `;
        };

        const renderAgendaSemana = () => {
            const hoje = new Date();
            const dias = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'S√°b'];
            let html = '<div class="stats-grid">';
            
            for (let i = 0; i < 7; i++) {
                const data = new Date(hoje);
                data.setDate(hoje.getDate() + i);
                const dataStr = data.toISOString().split('T')[0];
                const count = App.data.agenda.filter(a => a.data === dataStr).length;
                
                html += `
                    <div class="stat-card" style="background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);">
                        <div>
                            <h3>${dias[data.getDay()]}</h3>
                            <div class="value">${count}</div>
                            <small>${dataStr}</small>
                        </div>
                    </div>
                `;
            }
            html += '</div>';
            
            return html;
        };

        const renderNovoAgendamento = () => {
            return `
                <div class="form-section">
                    <h3>‚ûï Novo Agendamento</h3>
                    <div class="form-grid">
                        <select id="agendaCliente">
                            <option value="">Selecione o cliente</option>
                            ${App.data.clientes.map(c => `<option value="${c.id}">${c.nome}</option>`).join('')}
                        </select>
                        <input type="date" id="agendaData" value="${new Date().toISOString().split('T')[0]}">
                        <input type="time" id="agendaHora" value="09:00">
                        <input type="text" id="agendaServico" placeholder="Servi√ßo">
                    </div>
                    <button class="btn-action success" onclick="salvarAgendamento()">Agendar</button>
                </div>
            `;
        };

        const salvarAgendamento = () => {
            const clienteId = document.getElementById('agendaCliente').value;
            const data = document.getElementById('agendaData').value;
            const hora = document.getElementById('agendaHora').value;
            const servico = document.getElementById('agendaServico').value;

            if (!clienteId || !data || !hora || !servico) {
                showToast('Preencha todos os campos', 'warning');
                return;
            }

            const cliente = App.data.clientes.find(c => c.id == clienteId);

            App.data.agenda.push({
                id: Date.now(),
                clienteId: parseInt(clienteId),
                clienteNome: cliente.nome,
                whatsapp: cliente.whatsapp,
                data,
                hora,
                servico
            });

            salvarDados();
            showToast('Agendamento realizado!', 'success');
            mostrarSubAgenda('hoje');
        };

        // ==================== FINANCEIRO ====================
        const renderFinanceiro = () => {
            const entradas = App.data.financeiro.filter(f => f.tipo === 'entrada').reduce((s, f) => s + f.valor, 0);
            const saidas = App.data.financeiro.filter(f => f.tipo === 'saida').reduce((s, f) => s + f.valor, 0);
            
            return `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div>
                            <h3>Entradas</h3>
                            <div class="value">${formatarMoeda(entradas)}</div>
                        </div>
                        <i class="fas fa-arrow-up stat-icon"></i>
                    </div>
                    <div class="stat-card">
                        <div>
                            <h3>Sa√≠das</h3>
                            <div class="value">${formatarMoeda(saidas)}</div>
                        </div>
                        <i class="fas fa-arrow-down stat-icon"></i>
                    </div>
                </div>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Data</th>
                                <th>Tipo</th>
                                <th>Descri√ß√£o</th>
                                <th>Valor</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${App.data.financeiro.map(f => `
                                <tr>
                                    <td>${formatarData(f.data)}</td>
                                    <td><span class="badge ${f.tipo === 'entrada' ? 'badge-success' : 'badge-danger'}">${f.tipo}</span></td>
                                    <td>${f.descricao}</td>
                                    <td>${formatarMoeda(f.valor)}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        };

        // ==================== RELAT√ìRIOS ====================
        const renderRelatorios = () => {
            return `
                <div class="form-section">
                    <h3>üìä Gerar Relat√≥rios</h3>
                    <div class="form-grid">
                        <select id="relTipo">
                            <option value="os">Ordens de Servi√ßo</option>
                            <option value="orcamentos">Or√ßamentos</option>
                            <option value="clientes">Clientes</option>
                        </select>
                        <input type="month" id="relMes" value="${new Date().toISOString().slice(0,7)}">
                    </div>
                    <button class="btn btn-primary" onclick="gerarRelatorioTela()">Visualizar</button>
                    <div id="relatorioResultado" style="margin-top: 20px;"></div>
                </div>
            `;
        };

        const gerarRelatorioTela = () => {
            const tipo = document.getElementById('relTipo').value;
            const mes = document.getElementById('relMes').value;
            
            let dados = [];
            if (tipo === 'os') dados = App.data.os.filter(o => o.data.startsWith(mes));
            else if (tipo === 'orcamentos') dados = App.data.orcamentos.filter(o => o.data.startsWith(mes));
            else dados = App.data.clientes;

            let html = '<div class="table-container"><table><thead><tr>';
            
            if (tipo === 'os') {
                html += '<th>N¬∫</th><th>Cliente</th><th>Valor</th><th>Status</th>';
            } else if (tipo === 'orcamentos') {
                html += '<th>N¬∫</th><th>Cliente</th><th>Valor</th><th>Status</th>';
            } else {
                html += '<th>Nome</th><th>Telefone</th><th>Email</th>';
            }
            
            html += '</tr></thead><tbody>';
            
            dados.forEach(d => {
                if (tipo === 'os' || tipo === 'orcamentos') {
                    html += `<tr><td>${d.numero}</td><td>${d.clienteNome}</td><td>${formatarMoeda(d.valor)}</td><td>${d.status}</td></tr>`;
                } else {
                    html += `<tr><td>${d.nome}</td><td>${d.telefone}</td><td>${d.email || '-'}</td></tr>`;
                }
            });
            
            html += '</tbody></table></div>';
            document.getElementById('relatorioResultado').innerHTML = html;
        };

        // ==================== CONFIGURA√á√ïES ====================
        const renderConfig = () => {
            return `
                <div class="form-section">
                    <h3>‚öôÔ∏è Configura√ß√µes</h3>
                    <div class="form-grid">
                        <input type="text" id="configEmpresa" value="${App.configuracoes.empresa}" placeholder="Empresa">
                        <input type="text" id="configTelefone" value="${App.configuracoes.telefone}" placeholder="Telefone">
                        <input type="text" id="configWhatsApp" value="${App.configuracoes.whatsapp}" placeholder="WhatsApp">
                        <input type="text" id="configEndereco" value="${App.configuracoes.endereco}" placeholder="Endere√ßo">
                    </div>
                    <button class="btn-action success" onclick="salvarConfig()">Salvar</button>
                </div>
            `;
        };

        const salvarConfig = () => {
            App.configuracoes = {
                empresa: document.getElementById('configEmpresa').value,
                telefone: document.getElementById('configTelefone').value,
                whatsapp: document.getElementById('configWhatsApp').value,
                endereco: document.getElementById('configEndereco').value
            };
            salvarDados();
            showToast('Configura√ß√µes salvas!', 'success');
        };

        // ==================== NAVEGA√á√ÉO ====================
        const showSection = (section, element) => {
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            element.classList.add('active');
            
            showLoading();
            setTimeout(() => {
                document.getElementById('mainContent').innerHTML = getSectionContent(section);
                if (section === 'orcamentos' && document.getElementById('servicosContainer')) {
                    renderServicos();
                }
                hideLoading();
            }, 300);
        };

        const getSectionContent = (section) => {
            const sections = {
                dashboard: renderDashboard,
                os: renderOS,
                orcamentos: renderOrcamentos,
                clientes: renderClientes,
                veiculos: renderVeiculos,
                funcionarios: renderFuncionarios,
                agenda: renderAgenda,
                financeiro: renderFinanceiro,
                relatorios: renderRelatorios,
                config: renderConfig
            };
            return sections[section] ? sections[section]() : '<p>Se√ß√£o n√£o encontrada</p>';
        };

        // ==================== SERVI√áOS (reutiliz√°vel) ====================
        const renderServicos = () => {
            let html = '';
            window.servicos.forEach((s, i) => {
                html += `
                    <div class="servico-linha">
                        <input class="servico-descricao" placeholder="Descri√ß√£o" value="${s.desc}" onchange="atualizarServico(${i}, 'desc', this.value)">
                        <input class="servico-valor" type="number" placeholder="Valor" value="${s.valor}" onchange="atualizarServico(${i}, 'valor', this.value)">
                        ${window.servicos.length > 1 ? `<button class="btn-action danger" onclick="removerServico(${i})"><i class="fas fa-times"></i></button>` : ''}
                    </div>
                `;
            });
            document.getElementById('servicosContainer').innerHTML = html;
        };

        const adicionarServico = () => {
            window.servicos.push({ desc: '', valor: 0 });
            renderServicos();
        };

        const removerServico = (i) => {
            window.servicos.splice(i, 1);
            renderServicos();
            calcularTotal();
        };

        const atualizarServico = (i, campo, valor) => {
            window.servicos[i][campo] = campo === 'valor' ? parseFloat(valor) || 0 : valor;
            calcularTotal();
        };

        const calcularTotal = () => {
            const total = window.servicos.reduce((s, i) => s + (i.valor || 0), 0);
            document.getElementById('osTotal').textContent = formatarMoeda(total);
        };

        // ==================== MODAL ====================
        const openModal = (title, content, onConfirm) => {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalBody').innerHTML = content;
            document.getElementById('modal').classList.add('active');
            document.getElementById('modalConfirmBtn').onclick = onConfirm || closeModal;
        };

        const closeModal = () => {
            document.getElementById('modal').classList.remove('active');
        };
    </script>
</body>
</html>
